#!/bin/bash

# Проверка наличия аргумента с путем к файлу
if [ $# -ne 1 ]; then
    echo "Использование: $0 путь/к/файлу_с_логами.txt"
    exit 1
fi

INPUT_FILE="$1"

# Проверка существования файла
if [ ! -f "$INPUT_FILE" ]; then
    echo "Ошибка: Файл '$INPUT_FILE' не найден"
    exit 1
fi

echo "Начинаю синхронизацию логов wandb из файла: $INPUT_FILE"
echo "----------------------------------------------------"

# Читаем файл построчно и выполняем команду для каждой строки
while IFS= read -r cmd || [ -n "$cmd" ]; do
    # Пропускаем пустые строки
    if [ -z "$cmd" ]; then
        continue
    fi
    
    echo "Выполняю: $cmd"
    $cmd
    
    # Небольшая пауза между синхронизациями
    sleep 1
    echo "----------------------------------------------------"
done < "$INPUT_FILE"

echo "Синхронизация завершена!" 